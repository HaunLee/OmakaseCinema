<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">

    <!--받아온 id가 이메일 또는 아이디와 일치하는지 그리고 비밀번호가 db에 있는 비밀번호와 일치하는지 셀렉트문-->
    <select id="login_check" parameterType="map" resultType="web.mybatis.vo.MemberVO">
        SELECT * FROM member WHERE (u_address = #{id} OR u_id = #{id}) AND u_pw = #{pw}
    </select>

    <!--아이디 중복체크-->
    <select id="id_check" parameterType="String" resultType="int">
        SELECT COUNT(*) FROM member WHERE u_id = #{id}
    </select>

    <!--회원가입-->
    <insert id="regist" parameterType="web.mybatis.vo.MemberVO">
        INSERT INTO member(u_id, u_pw, u_authority, u_social, u_name, u_phone,
    u_postcode, u_address, u_email, u_email_rcv, u_birth, u_status, u_join_date, u_none)
        VALUES(#{u_id}, #{u_pw}, #{u_authority}, #{u_social}, #{u_name}, #{u_phone}, #{u_postcode},
    #{u_address}, #{u_email}, #{u_email_rcv}, #{u_birth}, #{u_status}, #{u_join_date}, #{u_none})
    </insert>

    <!--이메일 중복확인-->
    <select id="email_check" parameterType="String" resultType="int">
        SELECT COUNT(*) FROM member WHERE u_email = #{email}
    </select>

    <!-- 소셜 로그인 할때 이메일이 존재하면 해당 mvo를 다 가져오는 sql문 -->
    <select id="get_member" parameterType="String" resultType="web.mybatis.vo.MemberVO">
        SELECT * FROM member WHERE u_email = #{email}
    </select>

    <!-- 소셜 로그인인지 확인하는 sql문장 -->
    <select id="social_login_check" parameterType="String" resultType="int">
        SELECT u_social FROM member WHERE u_email = #{email}
    </select>

    <select id="idToMvo" resultType="String">
        SELECT * FROM member WHERE u_id = #{id}
    </select>

	<select id="getMemList" resultType="web.mybatis.vo.MemberVO">
		SELECT * FROM member WHERE u_authority = 0
	</select>

</mapper>