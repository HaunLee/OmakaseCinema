<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="movieList">
	
    <!-- 영화 이름 -> MovieListVO -->
    <select id="getMovieVO" parameterType="String" resultType="web.mybatis.vo.MovieListVO">
        SELECT *
        FROM movie_list
        WHERE movieNm = #{movieNm}
    </select>

    <select id="getMVO" parameterType="String" resultType="web.mybatis.vo.MovieListVO">
        SELECT *
        FROM movie_list
        WHERE movieCd = #{movieCd}
    </select>

    <insert id="insertMovie" parameterType="web.mybatis.vo.MovieListVO">
        INSERT INTO movie_list(movieCd, movieNm,movieNmEn,prdtYear,showTm,openDt,typeNm,
        nationNm,genreNm,directors,peopleNm,peopleNmEn,actors,cast,castEn,showTypeGroupNm,
        showTypeNm,watchGradeNm,m_plot)
        VALUES(#{movieCd}, #{movieNm},#{movieNmEn},#{prdtYear},#{showTm},#{openDt},#{typeNm},
        #{nationNm},#{genreNm},#{directors},#{peopleNm},#{peopleNmEn},#{actors},#{cast},#{castEn},#{showTypeGroupNm},
        #{showTypeNm},#{watchGradeNm},#{m_plot} )
    </insert>

    <select id="selectMovie" resultType="web.mybatis.vo.MovieListVO" parameterType="Map">
        SELECT * FROM(
        SELECT @RN:=@RN+1 AS rnum, a.* FROM(
        SELECT * FROM movie_list
        ) a, (SELECT @RN:=0) b
        ) c WHERE c.rnum between #{begin} AND #{end}
    </select>

    <insert id="insertScreen" parameterType="web.mybatis.vo.ScreeningScheduleVO">
        INSERT INTO screening_schedule(movieCd, ss_time, ss_date, t_name)
        VALUES(#{movieCd}, #{ss_time}, #{ss_date}, #{t_name})
    </insert>

    <select id="count" resultType="int">
        SELECT COUNT(*)
        FROM movie_list
    </select>

	<select id="searchMovie" parameterType="String" resultType="web.mybatis.vo.MovieListVO">
		SELECT *
		FROM movie_list
		WHERE movieNm LIKE CONCAT('%', #{movieNm}, '%')
	</select>

</mapper>